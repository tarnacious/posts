<div class="entry">
<p>I’m doing an introduction to IronPython presentation at the Victoria .Net user group tomorrow, I’ve been attending the user group for about a year and I’m pretty excited about presenting. I think python is a fantastic language and it’s great to be able to build software on the .Net framework with it.&#160;&#160;&#160;&#160;&#160;&#160;&#160; </p> <h2>The Slides </h2> <table cellspacing="0" cellpadding="2" width="100%" border="0"><tbody> <tr> <td valign="top" width="200"><img height="210" src="introduction.png" width="280" /></td> <td valign="top" width="391"> <h4>Introduction</h4> <p>I wanted to start with the second slide and have a photo of a pub on the contact slide but decided to get through this before trying out PowerPoint jokes. </p> </td> </tr> <tr> <td valign="top" width="200"><img height="210" src="why-python.png" width="280" /></td> <td valign="top" width="391"> <h4>Why Python</h4> I just plan to discuss <a href="http://blog.sharpthinking.com.au/post/2008/12/28/A-taste-of-Python.aspx">Why I started using Python.</a> The cartoon is, of course, <a href="http://xkcd.com/353/">XKCD</a>. </td> </tr> <tr> <td valign="top" width="200"><img height="210" src="python.png" width="280" /></td> <td valign="top" width="391"> <h4>Python </h4> Basic information about the language and its background. Would have liked to have added <a href="http://www.python.org/doc/essays/metaclasses/">meta programming</a> or at least “..” to the paradigms.           <br /> <br />I think it’s a fantastic language so I’ll mention it’s expressive, fun, productive or whatever adjectives I’ve got in my head at the time. </td> </tr> <tr> <td valign="top" width="200"><img height="210" src="who-uses_it.png" width="280" /></td> <td valign="top" width="391"> <h4>People using Python</h4> I really want to demonstrate that Python is real language, being used by real people, to write real code.&#160; <br /> <br />I probably should also have mentioned <a href="http://code.google.com/appengine/">Google App Engine</a> here which I’ve been tinkering with a bit recently and think is pretty cool.</td> </tr> <tr> <td valign="top" width="200"><img height="212" src="iron-python.png" width="280" /></td> <td valign="top" width="391"> <h4>IronPython</h4> <p>The Python language on .Net. Most of the demo is doing cool stuff in .Net with the Python language. I think it goes further than this and allows developers to use their own paradigms and patterns to do .NET development. </p> </td> </tr> <tr> <td valign="top" width="200"><img height="209" src="code-comparision.png" width="280" /> </td> <td valign="top" width="391"> <h4>C# and IronPython comparison</h4> I saw this example in the awesome <a href="http://www.manning.com/foord/">Iron Python in Action</a> book. I included it as it’s a great introduction IronPython code, as it clearly and simply shows differences on similarities with C#. </td> </tr> <tr> <td valign="top" width="200"><img height="209" src="dynamic-language-runtime.png" width="280" /></td> <td valign="top" width="391"> <h4>Dynamic Language Runtime</h4> <p>The <a href="http://dlr.codeplex.com/">Dynamic Language Runtime</a> project is open source. Its quite well <a href="http://en.wikipedia.org/wiki/Dynamic_Language_Runtime">described here</a> as:&#160; </p> <li>A dynamic <a href="http://en.wikipedia.org/wiki/Type_system">type system</a> </li> <li><a href="http://en.wikipedia.org/wiki/Dynamic_dispatch">Dynamic method dispatch</a> </li> <li><a href="http://en.wikipedia.org/wiki/Runtime_code_generation">Dynamic code generation</a> <p><a href="http://www.codeplex.com/IronLisp">IronLisp</a> has been superseded by the <a href="http://www.codeplex.com/IronScheme">IronScheme</a> project.</p> </li> </td> </tr> <tr> <td valign="top" width="200"><img height="211" src="dynamic-typing.png" width="280" /></td> <td valign="top" width="391"> <h4>Dynamic Typing </h4> <p>This slide is just a brief overview of what <a href="http://en.wikipedia.org/wiki/Duck_typing" target="_blank">duck typing</a> is. </p> <p>It is great for writing test objects, but I have a slide for the later. </p> <p>&#160;</p> <p></p> </td> </tr> <tr> <td valign="top" width="200"><img height="209" src="interactive-interpreter.png" width="280" /></td> <td valign="top" width="391"> <h4>Interactive Interpreter </h4> <p>I think it’s awesomely cool, and I use it through the entire demo so I thought it might be worth warning people.</p> </td> </tr> </tbody></table> <h3>&#160;</h3> <h2>The Demo</h2> <p>The demo is a series of scripts run into the IronPython Interactive Console. I’ve uploaded the very small collection of scripts for this demo <a href="http://static.sharpthinking.com.au/2009/iron_python_presentation/demo.zip">here</a>.</p> <h4>IronPython and the CLR</h4> <p>Create a string, show how its methods can be reflected. Import the CLR and show how the .Net String methods are now available.</p> <div> <pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none"><span style="color: #008000"># Introduction to IronPython and the CLR</span>

<span style="color: #008000"># Standard first Python console command</span>
2 + 2

<span style="color: #008000"># Create a string</span>
s = <span style="color: #006080">'Hello IronPython'</span>

<span style="color: #008000"># Inspect its methods, note that its only Python methods.  </span>
dir(s)

<span style="color: #008000"># Python has a method to make the text uppercase</span>
s.upper()

<span style="color: #008000"># Import the CLR</span>
import clr

<span style="color: #008000"># Now look at the same objects methods,</span>
<span style="color: #008000"># We now see the .NET string methods!</span>
dir(s)

<span style="color: #008000"># And can use them!</span>
s.ToUpper()</pre>
</div>
<p>&#160;</p>
<p><a href="http://static.sharpthinking.com.au/2009/iron_python_presentation/python-and-the-clr.png" target="_blank">Screen Shot</a></p>
<h4>Using a .Net Classes</h4>
<p>Create a <a href="http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx">WebClient</a> object from the .Net framework to download an RSS feed. Use an xml2py module written by <a href="http://www.devhawk.net/">Harry Pierson</a> to deserialise the RSS feed into an object graph. Then send the dates and titles to the <a href="http://msdn.microsoft.com/en-us/library/system.speech.synthesis.speechsynthesizer.aspx">Speech Synthesizer</a>. I’ve seen this done before in an IronPython presentation, and just thought it was to much fun to leave out.&#160; </p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">import clr

<span style="color: #008000"># Create a WebClient and download a string of XML</span>
from System.Net import WebClient
w = WebClient()
xml = w.DownloadString(<span style="color: #006080">'http://feeds.theage.com.au/rssheadlines/technology.xml'</span>)

<span style="color: #008000"># Lets have a look at first 60 characters of the xml..</span>
print xml[0:60]

<span style="color: #008000"># If bad stuff happens in the presentation..</span>
<span style="color: #008000">#xml = open('theage.rss').read()</span>

<span style="color: #008000"># Deserialize to objects using xml2py</span>
from devhawk import xml2py
rss = xml2py.parseString(xml)

<span style="color: #008000"># Print the results</span>
<span style="color: #0000ff">for</span> post <span style="color: #0000ff">in</span> rss.channel.item:
  print post.pubDate, post.title 

<span style="color: #008000"># Import Speech  </span>
clr.AddReference(<span style="color: #006080">'System.Speech'</span>)
from System.Speech import *
ss = Synthesis.SpeechSynthesizer()

<span style="color: #008000"># Say titles and dates using the SpeechSynthesizer </span>
<span style="color: #0000ff">for</span> post <span style="color: #0000ff">in</span> rss.channel.item:
  s = <span style="color: #006080">&quot;%s. %s.&quot;</span> % (post.pubDate[:16], post.title)
  ss.SpeakAsync(s)</pre>
</div>
<p>&#160;</p>
<p><a href="http://static.sharpthinking.com.au/2009/iron_python_presentation/webclient-xml2py-speech.png">Screen Shot</a></p>
<h4>SQL </h4>
<p>I really don’t want to do this in the presentation. I did spend a fair amount of time playing round with asynchronous SQL queries for use in a WPF application, but it seemed too complicated for the demo so I’ve left it out. I use </p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none"><span style="color: #008000"># import a simple wrapper around System.Data.SqlClient  </span>
<span style="color: #008000"># the wrapper is on my blog, I just wanted to show the AdventureWorks </span>
<span style="color: #008000"># database, it seems a bit of .NET presentation tradition. </span>
from demo import sql

<span style="color: #008000"># setup a query on the AdventureWords database</span>
query = <span style="color: #006080">'SELECT * FROM Production.Product'</span>
sql.connection = <span style="color: #006080">'Data Source=localhost\SQLEXPRESS;Initial Catalog=AdventureWorks;Integrated Security=SSPI;'</span>

<span style="color: #008000"># execute the query</span>
products = sql.SqlQuery(query)

<span style="color: #008000"># print some results</span>
<span style="color: #0000ff">for</span> p <span style="color: #0000ff">in</span> products[:5]:
  print p.Name</pre>
</div>
<h4>&#160;</h4>
<h4>WPF, Data Binding and Exec </h4>
<p>I think there is some pretty cool stuff in this demo. Although it takes a lot more to write real applications it does open new ways to develop and test .Net applications.</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none"><span style="color: #008000"># More pythonic way of getting the feed.. lets hope I have internet</span>
from devhawk import xml2py
rss = xml2py.parse(<span style="color: #006080">'http://feeds.theage.com.au/rssheadlines/technology.xml'</span>)

<span style="color: #008000"># Importing avalon starts a new thread to run the WPF application</span>
<span style="color: #008000"># It sets up some dispatures so the console can talk to the GUI </span>
from samples import avalon

<span style="color: #008000"># Create a window, show it and load some XAML into it</span>
w = avalon.Window()
w.Show()
xaml = avalon.LoadXaml(<span style="color: #006080">'demo.xaml'</span>)
w.Content = xaml

<span style="color: #008000"># Loading names is really cool, it traverses the control tree </span>
<span style="color: #008000"># described in the XAML and creates a dictionary of names and </span>
<span style="color: #008000"># controls. We can add those dictionary items to the local scope,</span>
<span style="color: #008000"># so we get the same effect as a generated designer files in</span>
<span style="color: #008000"># Visual Studio. </span>
avalon.LoadNames(xaml,locals())

<span style="color: #008000"># We can bind a Python list of Python objects to the ListView</span>
listView.ItemsSource = rss.channel.item

<span style="color: #008000"># Create a button click callback that will execute the script</span>
<span style="color: #008000"># in the query TextBox.</span>
def OnClick(*args):
  try:
    exec (query.Text)
  except:
    print <span style="color: #006080">&quot;Script threw an exception&quot;</span>
  pass  

<span style="color: #008000"># Wire up the click event to our function  </span>
execute.Click += OnClick
  
<span style="color: #008000"># We can now execute this on the client  </span>
listView.ItemsSource = [p <span style="color: #0000ff">for</span> p <span style="color: #0000ff">in</span> rss.channel.item <span style="color: #0000ff">if</span> p.title.find(<span style="color: #006080">'to'</span>) &gt;= 0]</pre>
</div>
<p>&#160;</p>
<p><a href="http://static.sharpthinking.com.au/2009/iron_python_presentation/execute-statements-databinding.png" target="_blank">Screen Shot</a></p>
<h2>More Slides</h2>
<table cellspacing="0" cellpadding="2" width="100%" border="0"><tbody>
<tr>
<td valign="top" width="200"><img height="210" src="testing-in-python.png" width="280" /></td>
<td valign="top" width="423">
<h3>Testing in Python</h3>
<p>It’s really cool you can do true test driven development in that you can write unit tests for classes and methods that haven’t yet been written. Some cool GUI testing is also possible using some the stuff in this presentation.&#160;&#160;&#160; </p>
</td>
</tr>
<tr>
<td valign="top" width="200"><img height="211" src="tools-sdks.png" width="280" /></td>
<td valign="top" width="423">
<h3>Tools / SDKs</h3>
I’m not expecting to mention <a href="www.codeplex.com/IronPythonStudio">Python Studio</a> or <a href="http://github.com/devhawk/ipydbg/tree/master">IpyDbg</a> as I’ll probably be running out of time. 

        <br />I really should have included a link to <a href="http://www.python.org/">python.org</a>, I’ll make sure I mention it. 

        <br />You can get <a href="www.codeplex.com/IronPython" target="_blank">IronPython here</a> and the <a href="www.codeplex.com/sdlsdk" target="_blank">Silverlight Dynamic Languages SDK</a></td>
</tr>
<tr>
<td valign="top" width="200"><img height="209" src="resources.png" width="280" /> </td>
<td valign="top" width="423">
<h3>Resources </h3>
<a href="http://www.diveintopython.org/">Dive Into Python</a> – Free online, python for programmers. 

        <br /><a href="www.manning.com/foord/">IronPython In Action</a> – Python and everything .NET with TDD and MVC practices. 

        <br /><a href="http://www.ironpython.info/index.php/Main_Page">IronPython Cookbook</a> – Online collection of IronPython .Net scripts. 

        <br /><a href="http://ironpython-urls.blogspot.com/">IronPython Urls</a>, MSDN, 

        <br /><a href="http://www.devhawk.net/">Devhawk</a> – Harry Pierson, Program Manager at Microsoft. 

        <br /><a href="http://www.voidspace.org.uk/ironpython/index.shtml">Voidspace</a> – Michael Foord, Author IronPython in Action.</td>
</tr>
<tr>
<td valign="top" width="200">
<p><img height="209" src="thanks.png" width="280" /></p>
</td>
<td valign="top" width="423">
<h3>Thanks</h3>
<p>By this stage I’ll almost certainly be running late, and probably be really worried about some minor disaster during the presentation.</p>
<p>I hope it goes well and everyone takes something out of it, I look forward to hearing what you thought.</p>
</td>
</tr>
</tbody></table>
<br />
</div>
